-- create database miniApartment
-- drop database miniApartment
use miniApartment;
CREATE TABLE `role` (
	id int auto_increment primary key,
    roleId INT,
    roleName VARCHAR(20)
);

create table contract(
	id bigint primary key auto_increment,
    contractId varchar(255),
    roomId int,
    numberOfTenant int,
    rentalFee decimal,
    securityDeposite decimal,
    paymentCycle int,
    signinDate date,
    moveinDate date,
    expireDate date,
    contractStatus int,
	representative nvarchar(100)
);
CREATE INDEX contractId ON contract(contractId);
create table contractDetail(
	contractId varchar(255) primary key,
    totalArea decimal,
    landArea decimal,
    publicArea decimal,
    privateArea decimal,
    device nvarchar(255),
    ownerOrigin nvarchar(255),
    ownerLimit nvarchar(255),
	rights nvarchar(255),
    obligations nvarchar(255),
    `commit` nvarchar(255),
    copies int,
    relationship varchar(20),
     FOREIGN KEY (contractId) REFERENCES contract(contractId)
);
create table `tenants`(
	id bigint auto_increment primary key,
	email varchar(30),
    roomId int,
    firstName NVARCHAR(15),
    lastName NVARCHAR(15),
    gender BIT,
    dateOfBirth DATE,
    contact VARCHAR(15),
    citizenId varchar(255),
    createCitizenIdDate Date,
    createCitizenIdPlace nvarchar(99),
    career varchar(25),
    licensePLate varchar(25),
    vehicleType varchar(20),
    vehicleColor varchar(20),
    residenceStatus varchar(20),
    contractId varchar(255),
    placeOfPermanet NVARCHAR(100),
    foreign key(contractId) references contract(contractId)
);
CREATE INDEX idex_role_id ON role(roleId);
CREATE INDEX idx_users_email ON tenants(email);
CREATE TABLE `users` (
	id bigint auto_increment primary key,
    userId VARCHAR(255),
    firstName NVARCHAR(15),
    lastName NVARCHAR(15),
    gender BIT,
    dateOfBirth DATE,
    placeOfPermanet NVARCHAR(100),
    email VARCHAR(30),
    contact VARCHAR(15),
    citizenId varchar(255),
    password VARCHAR(255),
    image varchar(255),
    roleId INT,
    FOREIGN KEY (roleId) REFERENCES Role(roleId),
    FOREIGN KEY (email) REFERENCES tenants(email)
);
create table expensesDetail(
	paymentId bigint auto_increment primary key,
    roomId int,
	`year` year,
    `month` int,
    rentalFee decimal,
    electricity decimal,
    electricPreviousMeter double,
    electricCurrentMeter double,
    water decimal,
    waterPreviousMeter double,
    waterCurrentMeter double,
    internet decimal,
    service decimal,
    securityDeposite decimal,
    debt decimal,
    fine decimal,
    `status` varchar(20)
);
create table payment(
	id bigint primary key,
	roomId int,
	`year` year,
    `month` int,
    totalFee decimal,
    paid decimal,
    `status` varchar(20),
	foreign key (id) references expensesDetail(paymentId)
);
create table room(
	id bigint auto_increment primary key,
	roomId int,
	roomStatus bit,
    maxTenant int
);

-- ALTER TABLE users ADD CONSTRAINT tenant_user FOREIGN KEY(email) REFERENCES tenants(email);
CREATE INDEX idex_room_id ON room(roomId);
ALTER TABLE payment ADD CONSTRAINT payment_ibfk_2 FOREIGN KEY(roomId) REFERENCES room(roomId);
CREATE INDEX room_id ON room (roomId);
ALTER TABLE contract ADD CONSTRAINT room_ibfk_1 FOREIGN KEY(roomId) REFERENCES room(roomId);
-- ALTER TABLE users ADD CONSTRAINT tenants_unique UNIQUE(email);
-- create table `token`(
-- 	email VARCHAR(255),
--     token varchar(255),
--     expTime datetime,
--
-- )
INSERT INTO `miniapartment`.`role`
(`roleId`,
`roleName`)
VALUES
(1,
'citizen');
INSERT INTO `miniapartment`.`role`
(`roleId`,
`roleName`)
VALUES
(2,
'admin');
INSERT INTO room (roomId, roomStatus) VALUES (101, 0);
INSERT INTO room (roomId, roomStatus) VALUES (102, 0);
INSERT INTO room (roomId, roomStatus) VALUES (103, 0);
INSERT INTO room (roomId, roomStatus) VALUES (104, 0);
INSERT INTO room (roomId, roomStatus) VALUES (105, 0);
INSERT INTO room (roomId, roomStatus) VALUES (106, 0);

INSERT INTO room (roomId, roomStatus) VALUES (201, 0);
INSERT INTO room (roomId, roomStatus) VALUES (202, 0);
INSERT INTO room (roomId, roomStatus) VALUES (203, 0);
INSERT INTO room (roomId, roomStatus) VALUES (204, 0);
INSERT INTO room (roomId, roomStatus) VALUES (205, 0);
INSERT INTO room (roomId, roomStatus) VALUES (206, 0);

INSERT INTO room (roomId, roomStatus) VALUES (301, 0);
INSERT INTO room (roomId, roomStatus) VALUES (302, 0);
INSERT INTO room (roomId, roomStatus) VALUES (303, 0);
INSERT INTO room (roomId, roomStatus) VALUES (304, 0);
INSERT INTO room (roomId, roomStatus) VALUES (305, 0);
INSERT INTO room (roomId, roomStatus) VALUES (306, 0);

INSERT INTO room (roomId, roomStatus) VALUES (401, 0);
INSERT INTO room (roomId, roomStatus) VALUES (402, 0);
INSERT INTO room (roomId, roomStatus) VALUES (403, 0);
INSERT INTO room (roomId, roomStatus) VALUES (404, 0);
INSERT INTO room (roomId, roomStatus) VALUES (405, 0);
INSERT INTO room (roomId, roomStatus) VALUES (406, 0);

INSERT INTO room (roomId, roomStatus) VALUES (501, 0);
INSERT INTO room (roomId, roomStatus) VALUES (502, 0);
INSERT INTO room (roomId, roomStatus) VALUES (503, 0);
INSERT INTO room (roomId, roomStatus) VALUES (504, 0);
INSERT INTO room (roomId, roomStatus) VALUES (505, 0);
INSERT INTO room (roomId, roomStatus) VALUES (506, 0);
--
INSERT INTO `miniapartment`.`contract`
(`contractId`,`roomId`,`numberOfTenant`,`rentalFee`,`securityDeposite`,`paymentCycle`,`signinDate`,`moveinDate`,`expireDate`,`contractStatus`,`representative`)
VALUES
('1',101,1,'12000','122222',1,'2024-6-24','2024-6-26','2024-7-24',1,'tran tuan minh');

INSERT INTO `miniapartment`.`tenants`
(`email`,`roomId`,`firstName`,`lastName`,`gender`,`dateOfBirth`,`contact`,`citizenId`
,`career`,`licensePLate`,`vehicleType`,`vehicleColor`,`residenceStatus`,`contractId`)
VALUES
('minhtt14@fpt.com',101,'minh','tran tuan',1,'2003-12-24',0398707242,'024203123031',
'student','99AA-99999','wave','black','Failed',1);
INSERT INTO `miniapartment`.`tenants`
(`email`,`roomId`,`firstName`,`lastName`,`gender`,`dateOfBirth`,`contact`,`citizenId`
,`career`,`licensePLate`,`vehicleType`,`vehicleColor`,`residenceStatus`,`contractId`)
VALUES
('trantuanminhbg2003@gmail.com',101,'minh','tran tuan',1,'2003-12-24',0398707242,'024203123031',
'student','99AA-99999','wave','black','Failed',1);
INSERT INTO `miniapartment`.`tenants`
(`email`,`roomId`,`firstName`,`lastName`,`gender`,`dateOfBirth`,`contact`,`citizenId`
,`career`,`licensePLate`,`vehicleType`,`vehicleColor`,`residenceStatus`,`contractId`)
VALUES
('minhtthe173206@fpt.edu.vn',101,'minh','tran tuan',1,'2003-12-24',0398707242,'024203123031',
'student','99AA-99999','wave','black','Failed',1);

